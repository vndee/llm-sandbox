<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A lightweight and portable sandbox environment for running LLM-generated code safely using containers"><meta name=author content="Duy Huynh"><link href=https://vndee.github.io/llm-sandbox/getting-started/ rel=canonical><link rel=prev href=..><link href=../configuration/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>Getting Started - LLM Sandbox Documentation</title><link rel=stylesheet href=../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../assets/_mkdocstrings.css><link rel=stylesheet href=../stylesheets/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-WV2MGL0XKM"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-WV2MGL0XKM",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-WV2MGL0XKM",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#getting-started-with-llm-sandbox class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="LLM Sandbox Documentation" class="md-header__button md-logo" aria-label="LLM Sandbox Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> LLM Sandbox Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Getting Started </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/vndee/llm-sandbox title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vndee/llm-sandbox </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../configuration/ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../examples/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../api-reference/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../contributing/ class=md-tabs__link> Contributing </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="LLM Sandbox Documentation" class="md-nav__button md-logo" aria-label="LLM Sandbox Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> LLM Sandbox Documentation </label> <div class=md-nav__source> <a href=https://github.com/vndee/llm-sandbox title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> vndee/llm-sandbox </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Getting Started </span> </a> <nav class="md-nav md-nav--secondary" aria-label="On this page"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> On this page </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#installation class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> <nav class=md-nav aria-label=Installation> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-installation class=md-nav__link> <span class=md-ellipsis> Basic Installation </span> </a> </li> <li class=md-nav__item> <a href=#backend-specific-installation class=md-nav__link> <span class=md-ellipsis> Backend-Specific Installation </span> </a> </li> <li class=md-nav__item> <a href=#development-installation class=md-nav__link> <span class=md-ellipsis> Development Installation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> <nav class=md-nav aria-label="Quick Start"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#your-first-sandbox-session class=md-nav__link> <span class=md-ellipsis> Your First Sandbox Session </span> </a> </li> <li class=md-nav__item> <a href=#installing-libraries class=md-nav__link> <span class=md-ellipsis> Installing Libraries </span> </a> </li> <li class=md-nav__item> <a href=#working-with-different-languages class=md-nav__link> <span class=md-ellipsis> Working with Different Languages </span> </a> <nav class=md-nav aria-label="Working with Different Languages"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#javascript-example class=md-nav__link> <span class=md-ellipsis> JavaScript Example </span> </a> </li> <li class=md-nav__item> <a href=#java-example class=md-nav__link> <span class=md-ellipsis> Java Example </span> </a> </li> <li class=md-nav__item> <a href=#c-example class=md-nav__link> <span class=md-ellipsis> C++ Example </span> </a> </li> <li class=md-nav__item> <a href=#go-example class=md-nav__link> <span class=md-ellipsis> Go Example </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#capturing-plots-and-visualizations class=md-nav__link> <span class=md-ellipsis> Capturing Plots and Visualizations </span> </a> <nav class=md-nav aria-label="Capturing Plots and Visualizations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-plot-capture class=md-nav__link> <span class=md-ellipsis> Basic Plot Capture </span> </a> </li> <li class=md-nav__item> <a href=#plot-accumulation-and-clearing class=md-nav__link> <span class=md-ellipsis> Plot Accumulation and Clearing </span> </a> </li> <li class=md-nav__item> <a href=#r-language-support class=md-nav__link> <span class=md-ellipsis> R Language Support </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#using-different-backends class=md-nav__link> <span class=md-ellipsis> Using Different Backends </span> </a> <nav class=md-nav aria-label="Using Different Backends"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker-backend-default class=md-nav__link> <span class=md-ellipsis> Docker Backend (Default) </span> </a> </li> <li class=md-nav__item> <a href=#kubernetes-backend class=md-nav__link> <span class=md-ellipsis> Kubernetes Backend </span> </a> </li> <li class=md-nav__item> <a href=#podman-backend class=md-nav__link> <span class=md-ellipsis> Podman Backend </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#working-with-files class=md-nav__link> <span class=md-ellipsis> Working with Files </span> </a> </li> <li class=md-nav__item> <a href=#setting-resource-limits class=md-nav__link> <span class=md-ellipsis> Setting Resource Limits </span> </a> </li> <li class=md-nav__item> <a href=#basic-security-policies class=md-nav__link> <span class=md-ellipsis> Basic Security Policies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-use-cases class=md-nav__link> <span class=md-ellipsis> Common Use Cases </span> </a> <nav class=md-nav aria-label="Common Use Cases"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-llm-code-execution class=md-nav__link> <span class=md-ellipsis> 1. LLM Code Execution </span> </a> </li> <li class=md-nav__item> <a href=#2-data-analysis-pipeline class=md-nav__link> <span class=md-ellipsis> 2. Data Analysis Pipeline </span> </a> </li> <li class=md-nav__item> <a href=#3-testing-user-submitted-code class=md-nav__link> <span class=md-ellipsis> 3. Testing User-Submitted Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> <nav class=md-nav aria-label="Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-always-use-context-managers class=md-nav__link> <span class=md-ellipsis> 1. Always Use Context Managers </span> </a> </li> <li class=md-nav__item> <a href=#2-handle-errors-gracefully class=md-nav__link> <span class=md-ellipsis> 2. Handle Errors Gracefully </span> </a> </li> <li class=md-nav__item> <a href=#3-use-security-policies class=md-nav__link> <span class=md-ellipsis> 3. Use Security Policies </span> </a> </li> <li class=md-nav__item> <a href=#4-use-your-own-pre-built-images class=md-nav__link> <span class=md-ellipsis> 4. Use Your Own Pre-built Images </span> </a> </li> <li class=md-nav__item> <a href=#5-skip-environment-setup-for-production class=md-nav__link> <span class=md-ellipsis> 5. Skip Environment Setup for Production </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#container-runtime-not-found class=md-nav__link> <span class=md-ellipsis> Container Runtime Not Found </span> </a> </li> <li class=md-nav__item> <a href=#permission-errors class=md-nav__link> <span class=md-ellipsis> Permission Errors </span> </a> </li> <li class=md-nav__item> <a href=#import-errors class=md-nav__link> <span class=md-ellipsis> Import Errors </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../configuration/ class=md-nav__link> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../api-reference/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> <li class=md-nav__item> <a href=../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/vndee/llm-sandbox/edit/main/docs/getting-started.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <a href=https://github.com/vndee/llm-sandbox/raw/main/docs/getting-started.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg> </a> <h1 id=getting-started-with-llm-sandbox>Getting Started with LLM Sandbox<a class=headerlink href=#getting-started-with-llm-sandbox title="Permanent link">&para;</a></h1> <p>This guide will help you get up and running with LLM Sandbox in just a few minutes.</p> <h2 id=prerequisites>Prerequisites<a class=headerlink href=#prerequisites title="Permanent link">&para;</a></h2> <p>Before you begin, ensure you have:</p> <ul> <li><strong>Python 3.10 or higher</strong> installed</li> <li><strong>Container runtime</strong> (at least one of the following):<ul> <li>Docker Desktop or Docker Engine</li> <li>Kubernetes cluster (local or remote)</li> <li>Podman</li> </ul> </li> </ul> <h2 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">&para;</a></h2> <h3 id=basic-installation>Basic Installation<a class=headerlink href=#basic-installation title="Permanent link">&para;</a></h3> <p>Install the core package:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>pip<span class=w> </span>install<span class=w> </span>llm-sandbox
</span></code></pre></div> <h3 id=backend-specific-installation>Backend-Specific Installation<a class=headerlink href=#backend-specific-installation title="Permanent link">&para;</a></h3> <p>Install with support for specific backends:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Docker backend (most common)</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>pip<span class=w> </span>install<span class=w> </span><span class=s1>&#39;llm-sandbox[docker]&#39;</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=c1># Kubernetes backend</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>pip<span class=w> </span>install<span class=w> </span><span class=s1>&#39;llm-sandbox[k8s]&#39;</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=c1># Podman backend</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>pip<span class=w> </span>install<span class=w> </span><span class=s1>&#39;llm-sandbox[podman]&#39;</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=c1># All backends</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>pip<span class=w> </span>install<span class=w> </span><span class=s1>&#39;llm-sandbox[docker,k8s,podman]&#39;</span>
</span></code></pre></div> <h3 id=development-installation>Development Installation<a class=headerlink href=#development-installation title="Permanent link">&para;</a></h3> <p>For contributing or development:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/vndee/llm-sandbox.git
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=nb>cd</span><span class=w> </span>llm-sandbox
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>pip<span class=w> </span>install<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;.[dev]&#39;</span>
</span></code></pre></div> <h2 id=quick-start>Quick Start<a class=headerlink href=#quick-start title="Permanent link">&para;</a></h2> <h3 id=your-first-sandbox-session>Your First Sandbox Session<a class=headerlink href=#your-first-sandbox-session title="Permanent link">&para;</a></h3> <p>Let's run a simple Python code in a sandbox:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=c1># Create and use a sandbox session</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=s2>print(&quot;Hello from LLM Sandbox!&quot;)</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=s2>print(&quot;I&#39;m running in a secure container.&quot;)</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <p>Output: <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>Hello from LLM Sandbox!
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>I&#39;m running in a secure container.
</span></code></pre></div></p> <h3 id=installing-libraries>Installing Libraries<a class=headerlink href=#installing-libraries title="Permanent link">&para;</a></h3> <p>Install and use Python packages dynamically:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=c1># Run code with numpy</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=s2>import numpy as np</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=s2># Create an array</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=s2>arr = np.array([1, 2, 3, 4, 5])</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=s2>print(f&quot;Array: </span><span class=si>{arr}</span><span class=s2>&quot;)</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=s2>print(f&quot;Mean: {np.mean(arr)}&quot;)</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=s2>print(f&quot;Sum: {np.sum(arr)}&quot;)</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>,</span> <span class=n>libraries</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;numpy&quot;</span><span class=p>])</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <p>Output: <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>Array: [1 2 3 4 5]
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>Mean: 3.0
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>Sum: 15
</span></code></pre></div></p> <h3 id=working-with-different-languages>Working with Different Languages<a class=headerlink href=#working-with-different-languages title="Permanent link">&para;</a></h3> <p>LLM Sandbox supports multiple programming languages:</p> <h4 id=javascript-example>JavaScript Example<a class=headerlink href=#javascript-example title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;javascript&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=s2>const greeting = &quot;Hello from Node.js!&quot;;</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=s2>console.log(greeting);</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=s2>// Using a library</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=s2>const axios = require(&#39;axios&#39;);</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=s2>console.log(&quot;Axios loaded successfully!&quot;);</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>,</span> <span class=n>libraries</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;axios&quot;</span><span class=p>])</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <p>Output: <div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>Hello from Node.js!
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>Axios loaded successfully!
</span></code></pre></div></p> <h4 id=java-example>Java Example<a class=headerlink href=#java-example title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;java&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=s2>public class HelloWorld {</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=s2>    public static void main(String[] args) {</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=s2>        System.out.println(&quot;Hello from Java!&quot;);</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=s2>        // Print Java version</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=s2>        String version = System.getProperty(&quot;java.version&quot;);</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=s2>        System.out.println(&quot;Java version: &quot; + version);</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=s2>    }</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=s2>}</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <p>Output: <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>Hello from Java!
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>Java version: 17.0.1
</span></code></pre></div></p> <h4 id=c-example>C++ Example<a class=headerlink href=#c-example title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;cpp&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=s2>#include &lt;iostream&gt;</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=s2>int main() {</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=s2>    std::cout &lt;&lt; &quot;Hello from C++!&quot; &lt;&lt; std::endl;</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=s2>    return 0;</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=s2>}</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <p>Output: <div class="language-text highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>Hello from C++!
</span></code></pre></div></p> <h4 id=go-example>Go Example<a class=headerlink href=#go-example title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;go&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=s2>package main</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=s2>import &quot;fmt&quot;</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=s2>func main() {</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=s2>    fmt.Println(&quot;Hello from Go!&quot;)</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=s2>}</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <p>Output: <div class="language-text highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>Hello from Go!
</span></code></pre></div></p> <h3 id=capturing-plots-and-visualizations>Capturing Plots and Visualizations<a class=headerlink href=#capturing-plots-and-visualizations title="Permanent link">&para;</a></h3> <p>LLM Sandbox can automatically capture plots generated by your code by using the <code>ArtifactSandboxSession</code> class. Plotting is currently supported for <strong>Python</strong> and <strong>R</strong> languages, with support for additional languages coming in the future.</p> <h4 id=basic-plot-capture>Basic Plot Capture<a class=headerlink href=#basic-plot-capture title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c1># ruff: noqa: T201</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=kn>import</span><span class=w> </span><span class=nn>base64</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=kn>from</span><span class=w> </span><span class=nn>pathlib</span><span class=w> </span><span class=kn>import</span> <span class=n>Path</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>ArtifactSandboxSession</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=n>code</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=s2>import matplotlib.pyplot as plt</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=s2>import numpy as np</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=s2>plt.style.use(&#39;default&#39;)</span>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=s2># Generate data</span>
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a><span class=s2>x = np.linspace(0, 10, 100)</span>
</span><span id=__span-15-16><a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=s2>y1 = np.sin(x) + np.random.normal(0, 0.1, 100)</span>
</span><span id=__span-15-17><a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a><span class=s2>y2 = np.cos(x) + np.random.normal(0, 0.1, 100)</span>
</span><span id=__span-15-18><a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>
</span><span id=__span-15-19><a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a><span class=s2># Create plot</span>
</span><span id=__span-15-20><a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a><span class=s2>fig, axes = plt.subplots(2, 2, figsize=(12, 10))</span>
</span><span id=__span-15-21><a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a><span class=s2>axes[0, 0].plot(x, y1, &#39;b-&#39;, alpha=0.7)</span>
</span><span id=__span-15-22><a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a><span class=s2>axes[0, 0].set_title(&#39;Sine Wave&#39;)</span>
</span><span id=__span-15-23><a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a><span class=s2>axes[0, 1].scatter(x[::5], y2[::5], c=&#39;red&#39;, alpha=0.6)</span>
</span><span id=__span-15-24><a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a><span class=s2>axes[0, 1].set_title(&#39;Cosine Scatter&#39;)</span>
</span><span id=__span-15-25><a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a><span class=s2>axes[1, 0].hist(y1, bins=20, alpha=0.7, color=&#39;green&#39;)</span>
</span><span id=__span-15-26><a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a><span class=s2>axes[1, 0].set_title(&#39;Sine Distribution&#39;)</span>
</span><span id=__span-15-27><a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a><span class=s2>axes[1, 1].bar(range(10), np.random.rand(10), alpha=0.7)</span>
</span><span id=__span-15-28><a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a><span class=s2>axes[1, 1].set_title(&#39;Random Bar Chart&#39;)</span>
</span><span id=__span-15-29><a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a><span class=s2>plt.tight_layout()</span>
</span><span id=__span-15-30><a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a><span class=s2>plt.show()</span>
</span><span id=__span-15-31><a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a>
</span><span id=__span-15-32><a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a><span class=s2>print(&#39;Plot generated successfully!&#39;)</span>
</span><span id=__span-15-33><a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-15-34><a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a>
</span><span id=__span-15-35><a id=__codelineno-15-35 name=__codelineno-15-35 href=#__codelineno-15-35></a><span class=c1># Create a sandbox session</span>
</span><span id=__span-15-36><a id=__codelineno-15-36 name=__codelineno-15-36 href=#__codelineno-15-36></a><span class=k>with</span> <span class=n>ArtifactSandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-15-37><a id=__codelineno-15-37 name=__codelineno-15-37 href=#__codelineno-15-37></a>    <span class=c1># Run Python code safely</span>
</span><span id=__span-15-38><a id=__codelineno-15-38 name=__codelineno-15-38 href=#__codelineno-15-38></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
</span><span id=__span-15-39><a id=__codelineno-15-39 name=__codelineno-15-39 href=#__codelineno-15-39></a>
</span><span id=__span-15-40><a id=__codelineno-15-40 name=__codelineno-15-40 href=#__codelineno-15-40></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>  <span class=c1># Output: Plot generated successfully!</span>
</span><span id=__span-15-41><a id=__codelineno-15-41 name=__codelineno-15-41 href=#__codelineno-15-41></a>
</span><span id=__span-15-42><a id=__codelineno-15-42 name=__codelineno-15-42 href=#__codelineno-15-42></a>    <span class=k>for</span> <span class=n>plot</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>plots</span><span class=p>:</span>
</span><span id=__span-15-43><a id=__codelineno-15-43 name=__codelineno-15-43 href=#__codelineno-15-43></a>        <span class=k>with</span> <span class=n>Path</span><span class=p>(</span><span class=s2>&quot;docs/assets/example.png&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s2>&quot;wb&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-15-44><a id=__codelineno-15-44 name=__codelineno-15-44 href=#__codelineno-15-44></a>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>plot</span><span class=o>.</span><span class=n>content_base64</span><span class=p>))</span>
</span></code></pre></div> <p>Output: <div class="language-text highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>Plot generated successfully!
</span></code></pre></div></p> <p><img alt="Example Plot" src=../assets/example.png></p> <h4 id=plot-accumulation-and-clearing>Plot Accumulation and Clearing<a class=headerlink href=#plot-accumulation-and-clearing title="Permanent link">&para;</a></h4> <p>By default, plots accumulate across multiple code executions within the same session, allowing you to build a gallery of visualizations. You can manually clear plots when needed or automatically clear them before each run:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>ArtifactSandboxSession</span><span class=p>,</span> <span class=n>SandboxBackend</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=k>with</span> <span class=n>ArtifactSandboxSession</span><span class=p>(</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>    <span class=n>backend</span><span class=o>=</span><span class=n>SandboxBackend</span><span class=o>.</span><span class=n>DOCKER</span><span class=p>,</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=n>enable_plotting</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=c1># First run - generates plots 1-3</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>    <span class=n>result1</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=s2>import matplotlib.pyplot as plt</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=s2>plt.plot([1, 2, 3])</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=s2>plt.show()</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total plots: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result1</span><span class=o>.</span><span class=n>plots</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># Output: 1</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>    <span class=c1># Second run - accumulates, now have plots 1-4</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>    <span class=n>result2</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=s2>import matplotlib.pyplot as plt</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=s2>plt.plot([4, 5, 6])</span>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=s2>plt.show()</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total plots: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result2</span><span class=o>.</span><span class=n>plots</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># Output: 2</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a>
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a>    <span class=c1># Manually clear plots and reset counter</span>
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a>    <span class=n>session</span><span class=o>.</span><span class=n>clear_plots</span><span class=p>()</span>
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a>
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a>    <span class=c1># Third run - starts fresh from plot 1</span>
</span><span id=__span-17-28><a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a>    <span class=n>result3</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-17-29><a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=s2>import matplotlib.pyplot as plt</span>
</span><span id=__span-17-30><a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a><span class=s2>plt.plot([7, 8, 9])</span>
</span><span id=__span-17-31><a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a><span class=s2>plt.show()</span>
</span><span id=__span-17-32><a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-17-33><a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total plots: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result3</span><span class=o>.</span><span class=n>plots</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># Output: 1</span>
</span><span id=__span-17-34><a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a>
</span><span id=__span-17-35><a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a>    <span class=c1># Or automatically clear before running</span>
</span><span id=__span-17-36><a id=__codelineno-17-36 name=__codelineno-17-36 href=#__codelineno-17-36></a>    <span class=n>result4</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-17-37><a id=__codelineno-17-37 name=__codelineno-17-37 href=#__codelineno-17-37></a><span class=s2>import matplotlib.pyplot as plt</span>
</span><span id=__span-17-38><a id=__codelineno-17-38 name=__codelineno-17-38 href=#__codelineno-17-38></a><span class=s2>plt.plot([10, 11, 12])</span>
</span><span id=__span-17-39><a id=__codelineno-17-39 name=__codelineno-17-39 href=#__codelineno-17-39></a><span class=s2>plt.show()</span>
</span><span id=__span-17-40><a id=__codelineno-17-40 name=__codelineno-17-40 href=#__codelineno-17-40></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>,</span> <span class=n>clear_plots</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># Clears plots before execution</span>
</span><span id=__span-17-41><a id=__codelineno-17-41 name=__codelineno-17-41 href=#__codelineno-17-41></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total plots: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result4</span><span class=o>.</span><span class=n>plots</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># Output: 1</span>
</span></code></pre></div> <h4 id=r-language-support>R Language Support<a class=headerlink href=#r-language-support title="Permanent link">&para;</a></h4> <p>Plot capture also works seamlessly with R, supporting multiple plotting libraries:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>ArtifactSandboxSession</span><span class=p>,</span> <span class=n>SandboxBackend</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=k>with</span> <span class=n>ArtifactSandboxSession</span><span class=p>(</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;r&quot;</span><span class=p>,</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>    <span class=n>backend</span><span class=o>=</span><span class=n>SandboxBackend</span><span class=o>.</span><span class=n>DOCKER</span><span class=p>,</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=n>enable_plotting</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=s2># Base R plots</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=s2>plot(1:10, main=&#39;Line Plot&#39;)</span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=s2>hist(rnorm(100), main=&#39;Histogram&#39;)</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=s2># ggplot2 (if installed)</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=s2>library(ggplot2)</span>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=s2>ggplot(mtcars, aes(x=wt, y=mpg)) +</span>
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=s2>    geom_point() +</span>
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=s2>    labs(title=&#39;MPG vs Weight&#39;)</span>
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-18-19><a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>
</span><span id=__span-18-20><a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a>    <span class=c1># All plots are captured automatically</span>
</span><span id=__span-18-21><a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Captured </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>plots</span><span class=p>)</span><span class=si>}</span><span class=s2> plots&quot;</span><span class=p>)</span>
</span><span id=__span-18-22><a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a>    <span class=k>for</span> <span class=n>plot</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>plots</span><span class=p>:</span>
</span><span id=__span-18-23><a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Format: </span><span class=si>{</span><span class=n>plot</span><span class=o>.</span><span class=n>format</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Supported Plotting Libraries:</strong></p> <ul> <li><strong>Python</strong>: matplotlib, seaborn, plotly, bokeh</li> <li><strong>R</strong>: base R graphics, ggplot2, plotly, lattice</li> </ul> <p>For complete examples, see:</p> <ul> <li><a href=https://github.com/vndee/llm-sandbox/blob/main/examples/plot_clearing_example.py>Python Plot Clearing Example</a></li> <li><a href=https://github.com/vndee/llm-sandbox/blob/main/examples/r_plot_clearing_example.py>R Plot Clearing Example</a></li> </ul> <h3 id=using-different-backends>Using Different Backends<a class=headerlink href=#using-different-backends title="Permanent link">&para;</a></h3> <h4 id=docker-backend-default>Docker Backend (Default)<a class=headerlink href=#docker-backend-default title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span><span class=p>,</span> <span class=n>SandboxBackend</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>    <span class=n>backend</span><span class=o>=</span><span class=n>SandboxBackend</span><span class=o>.</span><span class=n>DOCKER</span><span class=p>,</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;print(&#39;Running on Docker!&#39;)&quot;</span><span class=p>)</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <h4 id=kubernetes-backend>Kubernetes Backend<a class=headerlink href=#kubernetes-backend title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>    <span class=n>backend</span><span class=o>=</span><span class=n>SandboxBackend</span><span class=o>.</span><span class=n>KUBERNETES</span><span class=p>,</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>    <span class=n>kube_namespace</span><span class=o>=</span><span class=s2>&quot;default&quot;</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;print(&#39;Running on Kubernetes!&#39;)&quot;</span><span class=p>)</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Important: Custom Pod Manifests</strong></p> <p>When using custom pod manifests with Kubernetes, ensure your manifest includes these <strong>required</strong> configurations:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># Required pod manifest structure</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=n>pod_manifest</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>    <span class=s2>&quot;apiVersion&quot;</span><span class=p>:</span> <span class=s2>&quot;v1&quot;</span><span class=p>,</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>    <span class=s2>&quot;kind&quot;</span><span class=p>:</span> <span class=s2>&quot;Pod&quot;</span><span class=p>,</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>    <span class=s2>&quot;metadata&quot;</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>        <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;your-pod-name&quot;</span><span class=p>,</span>  <span class=c1># Will be overridden with unique name</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>        <span class=s2>&quot;namespace&quot;</span><span class=p>:</span> <span class=s2>&quot;default&quot;</span><span class=p>,</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>    <span class=p>},</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>    <span class=s2>&quot;spec&quot;</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>        <span class=s2>&quot;containers&quot;</span><span class=p>:</span> <span class=p>[</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>            <span class=p>{</span>
</span><span id=__span-21-12><a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>                <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;my-container&quot;</span><span class=p>,</span>  <span class=c1># Can be any valid container name</span>
</span><span id=__span-21-13><a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>                <span class=s2>&quot;image&quot;</span><span class=p>:</span> <span class=s2>&quot;your-image:latest&quot;</span><span class=p>,</span>
</span><span id=__span-21-14><a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a>                <span class=s2>&quot;tty&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>  <span class=c1># REQUIRED: Keeps container alive</span>
</span><span id=__span-21-15><a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>                <span class=s2>&quot;securityContext&quot;</span><span class=p>:</span> <span class=p>{</span>  <span class=c1># REQUIRED: For proper permissions</span>
</span><span id=__span-21-16><a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a>                    <span class=s2>&quot;runAsUser&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-21-17><a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a>                    <span class=s2>&quot;runAsGroup&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-21-18><a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a>                <span class=p>},</span>
</span><span id=__span-21-19><a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a>                <span class=c1># Your other container settings...</span>
</span><span id=__span-21-20><a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a>            <span class=p>}</span>
</span><span id=__span-21-21><a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a>        <span class=p>],</span>
</span><span id=__span-21-22><a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a>        <span class=s2>&quot;securityContext&quot;</span><span class=p>:</span> <span class=p>{</span>  <span class=c1># REQUIRED: Pod-level security context</span>
</span><span id=__span-21-23><a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a>            <span class=s2>&quot;runAsUser&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-21-24><a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a>            <span class=s2>&quot;runAsGroup&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-21-25><a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a>        <span class=p>},</span>
</span><span id=__span-21-26><a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a>    <span class=p>},</span>
</span><span id=__span-21-27><a id=__codelineno-21-27 name=__codelineno-21-27 href=#__codelineno-21-27></a><span class=p>}</span>
</span><span id=__span-21-28><a id=__codelineno-21-28 name=__codelineno-21-28 href=#__codelineno-21-28></a>
</span><span id=__span-21-29><a id=__codelineno-21-29 name=__codelineno-21-29 href=#__codelineno-21-29></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span>
</span><span id=__span-21-30><a id=__codelineno-21-30 name=__codelineno-21-30 href=#__codelineno-21-30></a>    <span class=n>backend</span><span class=o>=</span><span class=n>SandboxBackend</span><span class=o>.</span><span class=n>KUBERNETES</span><span class=p>,</span>
</span><span id=__span-21-31><a id=__codelineno-21-31 name=__codelineno-21-31 href=#__codelineno-21-31></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
</span><span id=__span-21-32><a id=__codelineno-21-32 name=__codelineno-21-32 href=#__codelineno-21-32></a>    <span class=n>pod_manifest</span><span class=o>=</span><span class=n>pod_manifest</span>
</span><span id=__span-21-33><a id=__codelineno-21-33 name=__codelineno-21-33 href=#__codelineno-21-33></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-21-34><a id=__codelineno-21-34 name=__codelineno-21-34 href=#__codelineno-21-34></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;print(&#39;Custom manifest working!&#39;)&quot;</span><span class=p>)</span>
</span></code></pre></div> <p><strong> Critical Requirements:</strong> - <code>"tty": True</code> is essential for keeping the container alive - Both pod-level and container-level <code>securityContext</code> are required for proper permissions - Container name can be any valid name (no longer restricted to "sandbox-container") - Missing any of these will cause connection or permission errors</p> <h4 id=podman-backend>Podman Backend<a class=headerlink href=#podman-backend title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=kn>from</span><span class=w> </span><span class=nn>podman</span><span class=w> </span><span class=kn>import</span> <span class=n>PodmanClient</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=n>client</span> <span class=o>=</span> <span class=n>PodmanClient</span><span class=p>(</span><span class=n>base_url</span><span class=o>=</span><span class=s2>&quot;unix:///run/podman/podman.sock&quot;</span><span class=p>)</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>    <span class=n>backend</span><span class=o>=</span><span class=n>SandboxBackend</span><span class=o>.</span><span class=n>PODMAN</span><span class=p>,</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>    <span class=n>client</span><span class=o>=</span><span class=n>client</span><span class=p>,</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;print(&#39;Running on Podman!&#39;)&quot;</span><span class=p>)</span>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <h3 id=working-with-files>Working with Files<a class=headerlink href=#working-with-files title="Permanent link">&para;</a></h3> <p>Copy files to and from the sandbox:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>    <span class=c1># Copy file to sandbox</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>    <span class=n>session</span><span class=o>.</span><span class=n>copy_to_runtime</span><span class=p>(</span><span class=s2>&quot;local_data.csv&quot;</span><span class=p>,</span> <span class=s2>&quot;/sandbox/data.csv&quot;</span><span class=p>)</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>    <span class=c1># Process the file</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=s2>import pandas as pd</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=s2># Read the CSV file</span>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=s2>df = pd.read_csv(&#39;/sandbox/data.csv&#39;)</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=s2>print(f&quot;Shape: </span><span class=si>{df.shape}</span><span class=s2>&quot;)</span>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=s2>print(f&quot;Columns: {list(df.columns)}&quot;)</span>
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=s2>print(f&quot;First 5 rows:</span><span class=se>\n</span><span class=s2>{df.head()}&quot;)</span>
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>
</span><span id=__span-23-15><a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a><span class=s2># Save processed data</span>
</span><span id=__span-23-16><a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a><span class=s2>df.to_csv(&#39;/sandbox/processed.csv&#39;, index=False)</span>
</span><span id=__span-23-17><a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>,</span> <span class=n>libraries</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;pandas&quot;</span><span class=p>])</span>
</span><span id=__span-23-18><a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a>
</span><span id=__span-23-19><a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a>    <span class=c1># Copy file back from sandbox</span>
</span><span id=__span-23-20><a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a>    <span class=n>session</span><span class=o>.</span><span class=n>copy_from_runtime</span><span class=p>(</span><span class=s2>&quot;/sandbox/processed.csv&quot;</span><span class=p>,</span> <span class=s2>&quot;processed_data.csv&quot;</span><span class=p>)</span>
</span></code></pre></div> <h3 id=setting-resource-limits>Setting Resource Limits<a class=headerlink href=#setting-resource-limits title="Permanent link">&para;</a></h3> <p>Control resource usage with runtime configurations:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>    <span class=n>runtime_configs</span><span class=o>=</span><span class=p>{</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>        <span class=s2>&quot;cpu_count&quot;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>           <span class=c1># Limit to 2 CPU cores</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>        <span class=s2>&quot;mem_limit&quot;</span><span class=p>:</span> <span class=s2>&quot;512m&quot;</span><span class=p>,</span>      <span class=c1># Limit memory to 512MB</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>        <span class=s2>&quot;timeout&quot;</span><span class=p>:</span> <span class=mi>30</span><span class=p>,</span>            <span class=c1># 30 second timeout</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>    <span class=p>}</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=s2># This will run with limited resources</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=s2>import multiprocessing</span>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=s2>print(f&quot;Available CPUs: {multiprocessing.cpu_count()}&quot;)</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <h3 id=basic-security-policies>Basic Security Policies<a class=headerlink href=#basic-security-policies title="Permanent link">&para;</a></h3> <p>Implement basic security checks:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox.security</span><span class=w> </span><span class=kn>import</span> <span class=n>SecurityPolicy</span><span class=p>,</span> <span class=n>SecurityPattern</span><span class=p>,</span> <span class=n>SecurityIssueSeverity</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=c1># Create a security policy</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=n>policy</span> <span class=o>=</span> <span class=n>SecurityPolicy</span><span class=p>(</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a>    <span class=n>severity_threshold</span><span class=o>=</span><span class=n>SecurityIssueSeverity</span><span class=o>.</span><span class=n>MEDIUM</span><span class=p>,</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>    <span class=n>patterns</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a>        <span class=n>SecurityPattern</span><span class=p>(</span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a>            <span class=n>pattern</span><span class=o>=</span><span class=sa>r</span><span class=s2>&quot;os\.system&quot;</span><span class=p>,</span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;System command execution&quot;</span><span class=p>,</span>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a>            <span class=n>severity</span><span class=o>=</span><span class=n>SecurityIssueSeverity</span><span class=o>.</span><span class=n>HIGH</span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a>        <span class=p>),</span>
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a>        <span class=n>SecurityPattern</span><span class=p>(</span>
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a>            <span class=n>pattern</span><span class=o>=</span><span class=sa>r</span><span class=s2>&quot;eval\s*\(&quot;</span><span class=p>,</span>
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Dynamic code evaluation&quot;</span><span class=p>,</span>
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a>            <span class=n>severity</span><span class=o>=</span><span class=n>SecurityIssueSeverity</span><span class=o>.</span><span class=n>MEDIUM</span>
</span><span id=__span-25-17><a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a>        <span class=p>)</span>
</span><span id=__span-25-18><a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a>    <span class=p>]</span>
</span><span id=__span-25-19><a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a><span class=p>)</span>
</span><span id=__span-25-20><a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a>
</span><span id=__span-25-21><a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span> <span class=n>security_policy</span><span class=o>=</span><span class=n>policy</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-25-22><a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a>    <span class=c1># Check if code is safe before running</span>
</span><span id=__span-25-23><a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a>    <span class=n>code</span> <span class=o>=</span> <span class=s2>&quot;print(&#39;This is safe code&#39;)&quot;</span>
</span><span id=__span-25-24><a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a>    <span class=n>is_safe</span><span class=p>,</span> <span class=n>violations</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>is_safe</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
</span><span id=__span-25-25><a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a>
</span><span id=__span-25-26><a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a>    <span class=k>if</span> <span class=n>is_safe</span><span class=p>:</span>
</span><span id=__span-25-27><a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
</span><span id=__span-25-28><a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a>        <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span><span id=__span-25-29><a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-25-30><a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Code failed security check:&quot;</span><span class=p>)</span>
</span><span id=__span-25-31><a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a>        <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>violations</span><span class=p>:</span>
</span><span id=__span-25-32><a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  - </span><span class=si>{</span><span class=n>v</span><span class=o>.</span><span class=n>description</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <h2 id=common-use-cases>Common Use Cases<a class=headerlink href=#common-use-cases title="Permanent link">&para;</a></h2> <h3 id=1-llm-code-execution>1. LLM Code Execution<a class=headerlink href=#1-llm-code-execution title="Permanent link">&para;</a></h3> <p>Execute code generated by an LLM safely:</p> <p>Example with Langchain: <div class="language-python highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=c1># ruff: noqa: E501</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=c1># Reference: https://python.langchain.com/docs/how_to/custom_tools/</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=kn>from</span><span class=w> </span><span class=nn>langchain</span><span class=w> </span><span class=kn>import</span> <span class=n>hub</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=kn>from</span><span class=w> </span><span class=nn>langchain.agents</span><span class=w> </span><span class=kn>import</span> <span class=n>AgentExecutor</span><span class=p>,</span> <span class=n>create_tool_calling_agent</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=kn>from</span><span class=w> </span><span class=nn>langchain_core.tools</span><span class=w> </span><span class=kn>import</span> <span class=n>tool</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=kn>from</span><span class=w> </span><span class=nn>langchain_openai</span><span class=w> </span><span class=kn>import</span> <span class=n>ChatOpenAI</span>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a>
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a>
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>%(message)s</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a>
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a>
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a><span class=nd>@tool</span>
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a><span class=k>def</span><span class=w> </span><span class=nf>run_code</span><span class=p>(</span><span class=n>lang</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>code</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>libraries</span><span class=p>:</span> <span class=nb>list</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run code in a sandboxed environment.</span>
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a>
</span><span id=__span-26-22><a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a><span class=sd>    :param lang: The language of the code, must be one of [&#39;python&#39;, &#39;java&#39;, &#39;javascript&#39;, &#39;cpp&#39;, &#39;go&#39;, &#39;ruby&#39;].</span>
</span><span id=__span-26-23><a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a><span class=sd>    :param code: The code to run.</span>
</span><span id=__span-26-24><a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a><span class=sd>    :param libraries: The libraries to use, it is optional.</span>
</span><span id=__span-26-25><a id=__codelineno-26-25 name=__codelineno-26-25 href=#__codelineno-26-25></a><span class=sd>    :return: The output of the code.</span>
</span><span id=__span-26-26><a id=__codelineno-26-26 name=__codelineno-26-26 href=#__codelineno-26-26></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-26-27><a id=__codelineno-26-27 name=__codelineno-26-27 href=#__codelineno-26-27></a>    <span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=n>lang</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-26-28><a id=__codelineno-26-28 name=__codelineno-26-28 href=#__codelineno-26-28></a>        <span class=k>return</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>code</span><span class=p>,</span> <span class=n>libraries</span><span class=p>)</span><span class=o>.</span><span class=n>stdout</span>
</span><span id=__span-26-29><a id=__codelineno-26-29 name=__codelineno-26-29 href=#__codelineno-26-29></a>
</span><span id=__span-26-30><a id=__codelineno-26-30 name=__codelineno-26-30 href=#__codelineno-26-30></a>
</span><span id=__span-26-31><a id=__codelineno-26-31 name=__codelineno-26-31 href=#__codelineno-26-31></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
</span><span id=__span-26-32><a id=__codelineno-26-32 name=__codelineno-26-32 href=#__codelineno-26-32></a>    <span class=n>llm</span> <span class=o>=</span> <span class=n>ChatOpenAI</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4.1-nano&quot;</span><span class=p>,</span> <span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-26-33><a id=__codelineno-26-33 name=__codelineno-26-33 href=#__codelineno-26-33></a>    <span class=n>prompt</span> <span class=o>=</span> <span class=n>hub</span><span class=o>.</span><span class=n>pull</span><span class=p>(</span><span class=s2>&quot;hwchase17/openai-functions-agent&quot;</span><span class=p>)</span>
</span><span id=__span-26-34><a id=__codelineno-26-34 name=__codelineno-26-34 href=#__codelineno-26-34></a>    <span class=n>tools</span> <span class=o>=</span> <span class=p>[</span><span class=n>run_code</span><span class=p>]</span>
</span><span id=__span-26-35><a id=__codelineno-26-35 name=__codelineno-26-35 href=#__codelineno-26-35></a>
</span><span id=__span-26-36><a id=__codelineno-26-36 name=__codelineno-26-36 href=#__codelineno-26-36></a>    <span class=n>agent</span> <span class=o>=</span> <span class=n>create_tool_calling_agent</span><span class=p>(</span><span class=n>llm</span><span class=p>,</span> <span class=n>tools</span><span class=p>,</span> <span class=n>prompt</span><span class=p>)</span>  <span class=c1># type: ignore[arg-type]</span>
</span><span id=__span-26-37><a id=__codelineno-26-37 name=__codelineno-26-37 href=#__codelineno-26-37></a>    <span class=n>agent_executor</span> <span class=o>=</span> <span class=n>AgentExecutor</span><span class=p>(</span><span class=n>agent</span><span class=o>=</span><span class=n>agent</span><span class=p>,</span> <span class=n>tools</span><span class=o>=</span><span class=n>tools</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># type: ignore[arg-type]</span>
</span><span id=__span-26-38><a id=__codelineno-26-38 name=__codelineno-26-38 href=#__codelineno-26-38></a>    <span class=n>output</span> <span class=o>=</span> <span class=n>agent_executor</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span>
</span><span id=__span-26-39><a id=__codelineno-26-39 name=__codelineno-26-39 href=#__codelineno-26-39></a>        <span class=s2>&quot;input&quot;</span><span class=p>:</span> <span class=s2>&quot;Write python code to calculate Pi number by Monte Carlo method then run it.&quot;</span>
</span><span id=__span-26-40><a id=__codelineno-26-40 name=__codelineno-26-40 href=#__codelineno-26-40></a>    <span class=p>})</span>
</span><span id=__span-26-41><a id=__codelineno-26-41 name=__codelineno-26-41 href=#__codelineno-26-41></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Agent: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>output</span><span class=p>)</span>
</span><span id=__span-26-42><a id=__codelineno-26-42 name=__codelineno-26-42 href=#__codelineno-26-42></a>
</span><span id=__span-26-43><a id=__codelineno-26-43 name=__codelineno-26-43 href=#__codelineno-26-43></a>    <span class=n>output</span> <span class=o>=</span> <span class=n>agent_executor</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span><span class=s2>&quot;input&quot;</span><span class=p>:</span> <span class=s2>&quot;Write python code to calculate the factorial of a number then run it.&quot;</span><span class=p>})</span>
</span><span id=__span-26-44><a id=__codelineno-26-44 name=__codelineno-26-44 href=#__codelineno-26-44></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Agent: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>output</span><span class=p>)</span>
</span><span id=__span-26-45><a id=__codelineno-26-45 name=__codelineno-26-45 href=#__codelineno-26-45></a>
</span><span id=__span-26-46><a id=__codelineno-26-46 name=__codelineno-26-46 href=#__codelineno-26-46></a>    <span class=n>output</span> <span class=o>=</span> <span class=n>agent_executor</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span><span class=s2>&quot;input&quot;</span><span class=p>:</span> <span class=s2>&quot;Write python code to calculate the Fibonacci sequence then run it.&quot;</span><span class=p>})</span>
</span><span id=__span-26-47><a id=__codelineno-26-47 name=__codelineno-26-47 href=#__codelineno-26-47></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Agent: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>output</span><span class=p>)</span>
</span><span id=__span-26-48><a id=__codelineno-26-48 name=__codelineno-26-48 href=#__codelineno-26-48></a>
</span><span id=__span-26-49><a id=__codelineno-26-49 name=__codelineno-26-49 href=#__codelineno-26-49></a>    <span class=n>output</span> <span class=o>=</span> <span class=n>agent_executor</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span><span class=s2>&quot;input&quot;</span><span class=p>:</span> <span class=s2>&quot;Calculate the sum of the first 10000 numbers.&quot;</span><span class=p>})</span>
</span><span id=__span-26-50><a id=__codelineno-26-50 name=__codelineno-26-50 href=#__codelineno-26-50></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Agent: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>output</span><span class=p>)</span>
</span></code></pre></div></p> <p>Example with Langgraph: <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=kn>from</span><span class=w> </span><span class=nn>langchain_core.tools</span><span class=w> </span><span class=kn>import</span> <span class=n>tool</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=kn>from</span><span class=w> </span><span class=nn>langgraph.prebuilt</span><span class=w> </span><span class=kn>import</span> <span class=n>create_react_agent</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>%(message)s</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a><span class=nd>@tool</span>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=k>def</span><span class=w> </span><span class=nf>run_code</span><span class=p>(</span><span class=n>lang</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>code</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>libraries</span><span class=p>:</span> <span class=nb>list</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run code in a sandboxed environment.</span>
</span><span id=__span-27-15><a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a>
</span><span id=__span-27-16><a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a><span class=sd>    :param lang: The language of the code, must be one of [&#39;python&#39;, &#39;java&#39;, &#39;javascript&#39;, &#39;cpp&#39;, &#39;go&#39;, &#39;ruby&#39;].</span>
</span><span id=__span-27-17><a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a><span class=sd>    :param code: The code to run.</span>
</span><span id=__span-27-18><a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a><span class=sd>    :param libraries: The libraries to use, it is optional.</span>
</span><span id=__span-27-19><a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a><span class=sd>    :return: The output of the code.</span>
</span><span id=__span-27-20><a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-27-21><a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a>    <span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=n>lang</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-27-22><a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a>        <span class=k>return</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>code</span><span class=p>,</span> <span class=n>libraries</span><span class=p>)</span><span class=o>.</span><span class=n>stdout</span>
</span><span id=__span-27-23><a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a>
</span><span id=__span-27-24><a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a>
</span><span id=__span-27-25><a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
</span><span id=__span-27-26><a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a>    <span class=n>agent</span> <span class=o>=</span> <span class=n>create_react_agent</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&quot;openai:gpt-4.1-nano&quot;</span><span class=p>,</span> <span class=n>tools</span><span class=o>=</span><span class=p>[</span><span class=n>run_code</span><span class=p>])</span>
</span><span id=__span-27-27><a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-27-28><a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a>        <span class=s2>&quot;Agent: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-27-29><a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a>        <span class=n>agent</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span>
</span><span id=__span-27-30><a id=__codelineno-27-30 name=__codelineno-27-30 href=#__codelineno-27-30></a>            <span class=s2>&quot;messages&quot;</span><span class=p>:</span> <span class=p>[</span>
</span><span id=__span-27-31><a id=__codelineno-27-31 name=__codelineno-27-31 href=#__codelineno-27-31></a>                <span class=p>{</span>
</span><span id=__span-27-32><a id=__codelineno-27-32 name=__codelineno-27-32 href=#__codelineno-27-32></a>                    <span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span>
</span><span id=__span-27-33><a id=__codelineno-27-33 name=__codelineno-27-33 href=#__codelineno-27-33></a>                    <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=s2>&quot;Write python code to calculate Pi number by Monte Carlo method then run it.&quot;</span><span class=p>,</span>
</span><span id=__span-27-34><a id=__codelineno-27-34 name=__codelineno-27-34 href=#__codelineno-27-34></a>                <span class=p>}</span>
</span><span id=__span-27-35><a id=__codelineno-27-35 name=__codelineno-27-35 href=#__codelineno-27-35></a>            <span class=p>]</span>
</span><span id=__span-27-36><a id=__codelineno-27-36 name=__codelineno-27-36 href=#__codelineno-27-36></a>        <span class=p>}),</span>
</span><span id=__span-27-37><a id=__codelineno-27-37 name=__codelineno-27-37 href=#__codelineno-27-37></a>    <span class=p>)</span>
</span><span id=__span-27-38><a id=__codelineno-27-38 name=__codelineno-27-38 href=#__codelineno-27-38></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-27-39><a id=__codelineno-27-39 name=__codelineno-27-39 href=#__codelineno-27-39></a>        <span class=s2>&quot;Agent: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-27-40><a id=__codelineno-27-40 name=__codelineno-27-40 href=#__codelineno-27-40></a>        <span class=n>agent</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span>
</span><span id=__span-27-41><a id=__codelineno-27-41 name=__codelineno-27-41 href=#__codelineno-27-41></a>            <span class=s2>&quot;messages&quot;</span><span class=p>:</span> <span class=p>[</span>
</span><span id=__span-27-42><a id=__codelineno-27-42 name=__codelineno-27-42 href=#__codelineno-27-42></a>                <span class=p>{</span><span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span> <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=s2>&quot;Write python code to calculate the factorial of a number then run it.&quot;</span><span class=p>}</span>
</span><span id=__span-27-43><a id=__codelineno-27-43 name=__codelineno-27-43 href=#__codelineno-27-43></a>            <span class=p>]</span>
</span><span id=__span-27-44><a id=__codelineno-27-44 name=__codelineno-27-44 href=#__codelineno-27-44></a>        <span class=p>}),</span>
</span><span id=__span-27-45><a id=__codelineno-27-45 name=__codelineno-27-45 href=#__codelineno-27-45></a>    <span class=p>)</span>
</span><span id=__span-27-46><a id=__codelineno-27-46 name=__codelineno-27-46 href=#__codelineno-27-46></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-27-47><a id=__codelineno-27-47 name=__codelineno-27-47 href=#__codelineno-27-47></a>        <span class=s2>&quot;Agent: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-27-48><a id=__codelineno-27-48 name=__codelineno-27-48 href=#__codelineno-27-48></a>        <span class=n>agent</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span>
</span><span id=__span-27-49><a id=__codelineno-27-49 name=__codelineno-27-49 href=#__codelineno-27-49></a>            <span class=s2>&quot;messages&quot;</span><span class=p>:</span> <span class=p>[</span>
</span><span id=__span-27-50><a id=__codelineno-27-50 name=__codelineno-27-50 href=#__codelineno-27-50></a>                <span class=p>{</span><span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span> <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=s2>&quot;Write python code to calculate the Fibonacci sequence then run it.&quot;</span><span class=p>}</span>
</span><span id=__span-27-51><a id=__codelineno-27-51 name=__codelineno-27-51 href=#__codelineno-27-51></a>            <span class=p>]</span>
</span><span id=__span-27-52><a id=__codelineno-27-52 name=__codelineno-27-52 href=#__codelineno-27-52></a>        <span class=p>}),</span>
</span><span id=__span-27-53><a id=__codelineno-27-53 name=__codelineno-27-53 href=#__codelineno-27-53></a>    <span class=p>)</span>
</span><span id=__span-27-54><a id=__codelineno-27-54 name=__codelineno-27-54 href=#__codelineno-27-54></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span><span id=__span-27-55><a id=__codelineno-27-55 name=__codelineno-27-55 href=#__codelineno-27-55></a>        <span class=s2>&quot;Agent: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-27-56><a id=__codelineno-27-56 name=__codelineno-27-56 href=#__codelineno-27-56></a>        <span class=n>agent</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span><span class=s2>&quot;messages&quot;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span> <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=s2>&quot;Calculate the sum of the first 10000 numbers.&quot;</span><span class=p>}]}),</span>
</span><span id=__span-27-57><a id=__codelineno-27-57 name=__codelineno-27-57 href=#__codelineno-27-57></a>    <span class=p>)</span>
</span></code></pre></div></p> <p>Example with LlamaIndex: <div class="language-python highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1># ruff: noqa: E501</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=c1># Reference: https://docs.llamaindex.ai/en/stable/module_guides/deploying/agents/tools/</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=kn>import</span><span class=w> </span><span class=nn>nest_asyncio</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=kn>from</span><span class=w> </span><span class=nn>llama_index.core.agent</span><span class=w> </span><span class=kn>import</span> <span class=n>FunctionCallingAgentWorker</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=kn>from</span><span class=w> </span><span class=nn>llama_index.core.tools</span><span class=w> </span><span class=kn>import</span> <span class=n>FunctionTool</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=kn>from</span><span class=w> </span><span class=nn>llama_index.llms.openai</span><span class=w> </span><span class=kn>import</span> <span class=n>OpenAI</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=n>nest_asyncio</span><span class=o>.</span><span class=n>apply</span><span class=p>()</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>%(message)s</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a><span class=k>def</span><span class=w> </span><span class=nf>run_code</span><span class=p>(</span><span class=n>lang</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>code</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>libraries</span><span class=p>:</span> <span class=nb>list</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run code in a sandboxed environment.</span>
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a><span class=sd>    :param lang: The language of the code, must be one of [&#39;python&#39;, &#39;java&#39;, &#39;javascript&#39;, &#39;cpp&#39;, &#39;go&#39;, &#39;ruby&#39;].</span>
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a><span class=sd>    :param code: The code to run.</span>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a><span class=sd>    :param libraries: The libraries to use, it is optional.</span>
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a><span class=sd>    :return: The output of the code.</span>
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a>    <span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=n>lang</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a>        <span class=k>return</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>code</span><span class=p>,</span> <span class=n>libraries</span><span class=p>)</span><span class=o>.</span><span class=n>stdout</span>
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a>
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31 href=#__codelineno-28-31></a>
</span><span id=__span-28-32><a id=__codelineno-28-32 name=__codelineno-28-32 href=#__codelineno-28-32></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
</span><span id=__span-28-33><a id=__codelineno-28-33 name=__codelineno-28-33 href=#__codelineno-28-33></a>    <span class=n>llm</span> <span class=o>=</span> <span class=n>OpenAI</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4.1-nano&quot;</span><span class=p>,</span> <span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-28-34><a id=__codelineno-28-34 name=__codelineno-28-34 href=#__codelineno-28-34></a>    <span class=n>code_execution_tool</span> <span class=o>=</span> <span class=n>FunctionTool</span><span class=o>.</span><span class=n>from_defaults</span><span class=p>(</span><span class=n>fn</span><span class=o>=</span><span class=n>run_code</span><span class=p>)</span>
</span><span id=__span-28-35><a id=__codelineno-28-35 name=__codelineno-28-35 href=#__codelineno-28-35></a>
</span><span id=__span-28-36><a id=__codelineno-28-36 name=__codelineno-28-36 href=#__codelineno-28-36></a>    <span class=n>agent_worker</span> <span class=o>=</span> <span class=n>FunctionCallingAgentWorker</span><span class=o>.</span><span class=n>from_tools</span><span class=p>(</span>
</span><span id=__span-28-37><a id=__codelineno-28-37 name=__codelineno-28-37 href=#__codelineno-28-37></a>        <span class=p>[</span><span class=n>code_execution_tool</span><span class=p>],</span>
</span><span id=__span-28-38><a id=__codelineno-28-38 name=__codelineno-28-38 href=#__codelineno-28-38></a>        <span class=n>llm</span><span class=o>=</span><span class=n>llm</span><span class=p>,</span>
</span><span id=__span-28-39><a id=__codelineno-28-39 name=__codelineno-28-39 href=#__codelineno-28-39></a>        <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-28-40><a id=__codelineno-28-40 name=__codelineno-28-40 href=#__codelineno-28-40></a>        <span class=n>allow_parallel_tool_calls</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-28-41><a id=__codelineno-28-41 name=__codelineno-28-41 href=#__codelineno-28-41></a>    <span class=p>)</span>
</span><span id=__span-28-42><a id=__codelineno-28-42 name=__codelineno-28-42 href=#__codelineno-28-42></a>    <span class=n>agent</span> <span class=o>=</span> <span class=n>agent_worker</span><span class=o>.</span><span class=n>as_agent</span><span class=p>()</span>
</span><span id=__span-28-43><a id=__codelineno-28-43 name=__codelineno-28-43 href=#__codelineno-28-43></a>
</span><span id=__span-28-44><a id=__codelineno-28-44 name=__codelineno-28-44 href=#__codelineno-28-44></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>agent</span><span class=o>.</span><span class=n>chat</span><span class=p>(</span><span class=s2>&quot;Write python code to calculate Pi number by Monte Carlo method then run it.&quot;</span><span class=p>)</span>
</span><span id=__span-28-45><a id=__codelineno-28-45 name=__codelineno-28-45 href=#__codelineno-28-45></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span><span id=__span-28-46><a id=__codelineno-28-46 name=__codelineno-28-46 href=#__codelineno-28-46></a>
</span><span id=__span-28-47><a id=__codelineno-28-47 name=__codelineno-28-47 href=#__codelineno-28-47></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>agent</span><span class=o>.</span><span class=n>chat</span><span class=p>(</span><span class=s2>&quot;Write python code to calculate the factorial of a number then run it.&quot;</span><span class=p>)</span>
</span><span id=__span-28-48><a id=__codelineno-28-48 name=__codelineno-28-48 href=#__codelineno-28-48></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span><span id=__span-28-49><a id=__codelineno-28-49 name=__codelineno-28-49 href=#__codelineno-28-49></a>
</span><span id=__span-28-50><a id=__codelineno-28-50 name=__codelineno-28-50 href=#__codelineno-28-50></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>agent</span><span class=o>.</span><span class=n>chat</span><span class=p>(</span><span class=s2>&quot;Write python code to calculate the Fibonacci sequence then run it.&quot;</span><span class=p>)</span>
</span><span id=__span-28-51><a id=__codelineno-28-51 name=__codelineno-28-51 href=#__codelineno-28-51></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span><span id=__span-28-52><a id=__codelineno-28-52 name=__codelineno-28-52 href=#__codelineno-28-52></a>
</span><span id=__span-28-53><a id=__codelineno-28-53 name=__codelineno-28-53 href=#__codelineno-28-53></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>agent</span><span class=o>.</span><span class=n>chat</span><span class=p>(</span><span class=s2>&quot;Calculate the sum of the first 10000 numbers.&quot;</span><span class=p>)</span>
</span><span id=__span-28-54><a id=__codelineno-28-54 name=__codelineno-28-54 href=#__codelineno-28-54></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></code></pre></div></p> <h3 id=2-data-analysis-pipeline>2. Data Analysis Pipeline<a class=headerlink href=#2-data-analysis-pipeline title="Permanent link">&para;</a></h3> <p>Run data analysis safely:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=s2>import pandas as pd</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=s2>import numpy as np</span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=s2>import matplotlib.pyplot as plt</span>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=s2># Generate sample data</span>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=s2>np.random.seed(42)</span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=s2>data = {</span>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=s2>    &#39;sales&#39;: np.random.randint(100, 1000, 50),</span>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=s2>    &#39;customers&#39;: np.random.randint(10, 100, 50),</span>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=s2>    &#39;profit_margin&#39;: np.random.uniform(0.1, 0.5, 50)</span>
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a><span class=s2>}</span>
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a>
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a><span class=s2>df = pd.DataFrame(data)</span>
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a>
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a><span class=s2># Analysis</span>
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a><span class=s2>print(&quot;Data Summary:&quot;)</span>
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a><span class=s2>print(df.describe())</span>
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a><span class=s2>print(f&quot;</span><span class=se>\n</span><span class=s2>Total Sales: ${df[&#39;sales&#39;].sum():,}&quot;)</span>
</span><span id=__span-29-21><a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a><span class=s2>print(f&quot;Average Profit Margin: {df[&#39;profit_margin&#39;].mean():.2%}&quot;)</span>
</span><span id=__span-29-22><a id=__codelineno-29-22 name=__codelineno-29-22 href=#__codelineno-29-22></a>
</span><span id=__span-29-23><a id=__codelineno-29-23 name=__codelineno-29-23 href=#__codelineno-29-23></a><span class=s2># Visualization</span>
</span><span id=__span-29-24><a id=__codelineno-29-24 name=__codelineno-29-24 href=#__codelineno-29-24></a><span class=s2>plt.figure(figsize=(12, 4))</span>
</span><span id=__span-29-25><a id=__codelineno-29-25 name=__codelineno-29-25 href=#__codelineno-29-25></a>
</span><span id=__span-29-26><a id=__codelineno-29-26 name=__codelineno-29-26 href=#__codelineno-29-26></a><span class=s2>plt.subplot(1, 3, 1)</span>
</span><span id=__span-29-27><a id=__codelineno-29-27 name=__codelineno-29-27 href=#__codelineno-29-27></a><span class=s2>plt.hist(df[&#39;sales&#39;], bins=15, edgecolor=&#39;black&#39;)</span>
</span><span id=__span-29-28><a id=__codelineno-29-28 name=__codelineno-29-28 href=#__codelineno-29-28></a><span class=s2>plt.title(&#39;Sales Distribution&#39;)</span>
</span><span id=__span-29-29><a id=__codelineno-29-29 name=__codelineno-29-29 href=#__codelineno-29-29></a>
</span><span id=__span-29-30><a id=__codelineno-29-30 name=__codelineno-29-30 href=#__codelineno-29-30></a><span class=s2>plt.subplot(1, 3, 2)</span>
</span><span id=__span-29-31><a id=__codelineno-29-31 name=__codelineno-29-31 href=#__codelineno-29-31></a><span class=s2>plt.scatter(df[&#39;customers&#39;], df[&#39;sales&#39;])</span>
</span><span id=__span-29-32><a id=__codelineno-29-32 name=__codelineno-29-32 href=#__codelineno-29-32></a><span class=s2>plt.xlabel(&#39;Customers&#39;)</span>
</span><span id=__span-29-33><a id=__codelineno-29-33 name=__codelineno-29-33 href=#__codelineno-29-33></a><span class=s2>plt.ylabel(&#39;Sales&#39;)</span>
</span><span id=__span-29-34><a id=__codelineno-29-34 name=__codelineno-29-34 href=#__codelineno-29-34></a><span class=s2>plt.title(&#39;Sales vs Customers&#39;)</span>
</span><span id=__span-29-35><a id=__codelineno-29-35 name=__codelineno-29-35 href=#__codelineno-29-35></a>
</span><span id=__span-29-36><a id=__codelineno-29-36 name=__codelineno-29-36 href=#__codelineno-29-36></a><span class=s2>plt.subplot(1, 3, 3)</span>
</span><span id=__span-29-37><a id=__codelineno-29-37 name=__codelineno-29-37 href=#__codelineno-29-37></a><span class=s2>plt.boxplot(df[&#39;profit_margin&#39;])</span>
</span><span id=__span-29-38><a id=__codelineno-29-38 name=__codelineno-29-38 href=#__codelineno-29-38></a><span class=s2>plt.title(&#39;Profit Margin Distribution&#39;)</span>
</span><span id=__span-29-39><a id=__codelineno-29-39 name=__codelineno-29-39 href=#__codelineno-29-39></a>
</span><span id=__span-29-40><a id=__codelineno-29-40 name=__codelineno-29-40 href=#__codelineno-29-40></a><span class=s2>plt.tight_layout()</span>
</span><span id=__span-29-41><a id=__codelineno-29-41 name=__codelineno-29-41 href=#__codelineno-29-41></a><span class=s2>plt.show()</span>
</span><span id=__span-29-42><a id=__codelineno-29-42 name=__codelineno-29-42 href=#__codelineno-29-42></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>,</span> <span class=n>libraries</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;pandas&quot;</span><span class=p>,</span> <span class=s2>&quot;numpy&quot;</span><span class=p>,</span> <span class=s2>&quot;matplotlib&quot;</span><span class=p>])</span>
</span><span id=__span-29-43><a id=__codelineno-29-43 name=__codelineno-29-43 href=#__codelineno-29-43></a>
</span><span id=__span-29-44><a id=__codelineno-29-44 name=__codelineno-29-44 href=#__codelineno-29-44></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <h3 id=3-testing-user-submitted-code>3. Testing User-Submitted Code<a class=headerlink href=#3-testing-user-submitted-code title="Permanent link">&para;</a></h3> <p>Safely test code submitted by users:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=k>def</span><span class=w> </span><span class=nf>test_user_code</span><span class=p>(</span><span class=n>code</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>test_cases</span><span class=p>:</span> <span class=nb>list</span><span class=p>):</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Test user code against test cases&quot;&quot;&quot;</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>    <span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a>        <span class=c1># Inject test framework</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a>        <span class=n>full_code</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=si>{</span><span class=n>code</span><span class=si>}</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=s2># Run test cases</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=s2>test_results = []</span>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>
</span><span id=__span-30-12><a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>test</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>test_cases</span><span class=p>):</span>
</span><span id=__span-30-13><a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>            <span class=n>full_code</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-30-14><a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a><span class=s2>try:</span>
</span><span id=__span-30-15><a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=s2>    result = </span><span class=si>{</span><span class=n>test</span><span class=p>[</span><span class=s1>&#39;call&#39;</span><span class=p>]</span><span class=si>}</span>
</span><span id=__span-30-16><a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a><span class=s2>    expected = </span><span class=si>{</span><span class=n>test</span><span class=p>[</span><span class=s1>&#39;expected&#39;</span><span class=p>]</span><span class=si>}</span>
</span><span id=__span-30-17><a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=s2>    passed = result == expected</span>
</span><span id=__span-30-18><a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a><span class=s2>    test_results.append(</span><span class=se>{{</span>
</span><span id=__span-30-19><a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a><span class=s2>        &#39;test&#39;: </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>,</span>
</span><span id=__span-30-20><a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a><span class=s2>        &#39;passed&#39;: passed,</span>
</span><span id=__span-30-21><a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a><span class=s2>        &#39;expected&#39;: expected,</span>
</span><span id=__span-30-22><a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a><span class=s2>        &#39;actual&#39;: result</span>
</span><span id=__span-30-23><a id=__codelineno-30-23 name=__codelineno-30-23 href=#__codelineno-30-23></a><span class=s2>    </span><span class=se>}}</span><span class=s2>)</span>
</span><span id=__span-30-24><a id=__codelineno-30-24 name=__codelineno-30-24 href=#__codelineno-30-24></a><span class=s2>except Exception as e:</span>
</span><span id=__span-30-25><a id=__codelineno-30-25 name=__codelineno-30-25 href=#__codelineno-30-25></a><span class=s2>    test_results.append(</span><span class=se>{{</span>
</span><span id=__span-30-26><a id=__codelineno-30-26 name=__codelineno-30-26 href=#__codelineno-30-26></a><span class=s2>        &#39;test&#39;: </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>,</span>
</span><span id=__span-30-27><a id=__codelineno-30-27 name=__codelineno-30-27 href=#__codelineno-30-27></a><span class=s2>        &#39;passed&#39;: False,</span>
</span><span id=__span-30-28><a id=__codelineno-30-28 name=__codelineno-30-28 href=#__codelineno-30-28></a><span class=s2>        &#39;error&#39;: str(e)</span>
</span><span id=__span-30-29><a id=__codelineno-30-29 name=__codelineno-30-29 href=#__codelineno-30-29></a><span class=s2>    </span><span class=se>}}</span><span class=s2>)</span>
</span><span id=__span-30-30><a id=__codelineno-30-30 name=__codelineno-30-30 href=#__codelineno-30-30></a><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-30-31><a id=__codelineno-30-31 name=__codelineno-30-31 href=#__codelineno-30-31></a>
</span><span id=__span-30-32><a id=__codelineno-30-32 name=__codelineno-30-32 href=#__codelineno-30-32></a>        <span class=n>full_code</span> <span class=o>+=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-30-33><a id=__codelineno-30-33 name=__codelineno-30-33 href=#__codelineno-30-33></a><span class=s2># Print results</span>
</span><span id=__span-30-34><a id=__codelineno-30-34 name=__codelineno-30-34 href=#__codelineno-30-34></a><span class=s2>for result in test_results:</span>
</span><span id=__span-30-35><a id=__codelineno-30-35 name=__codelineno-30-35 href=#__codelineno-30-35></a><span class=s2>    print(result)</span>
</span><span id=__span-30-36><a id=__codelineno-30-36 name=__codelineno-30-36 href=#__codelineno-30-36></a><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-30-37><a id=__codelineno-30-37 name=__codelineno-30-37 href=#__codelineno-30-37></a>
</span><span id=__span-30-38><a id=__codelineno-30-38 name=__codelineno-30-38 href=#__codelineno-30-38></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>full_code</span><span class=p>)</span>
</span><span id=__span-30-39><a id=__codelineno-30-39 name=__codelineno-30-39 href=#__codelineno-30-39></a>        <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=n>stdout</span>
</span><span id=__span-30-40><a id=__codelineno-30-40 name=__codelineno-30-40 href=#__codelineno-30-40></a>
</span><span id=__span-30-41><a id=__codelineno-30-41 name=__codelineno-30-41 href=#__codelineno-30-41></a><span class=c1># Example usage</span>
</span><span id=__span-30-42><a id=__codelineno-30-42 name=__codelineno-30-42 href=#__codelineno-30-42></a><span class=n>user_code</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-30-43><a id=__codelineno-30-43 name=__codelineno-30-43 href=#__codelineno-30-43></a><span class=s2>def add(a, b):</span>
</span><span id=__span-30-44><a id=__codelineno-30-44 name=__codelineno-30-44 href=#__codelineno-30-44></a><span class=s2>    return a + b</span>
</span><span id=__span-30-45><a id=__codelineno-30-45 name=__codelineno-30-45 href=#__codelineno-30-45></a>
</span><span id=__span-30-46><a id=__codelineno-30-46 name=__codelineno-30-46 href=#__codelineno-30-46></a><span class=s2>def multiply(a, b):</span>
</span><span id=__span-30-47><a id=__codelineno-30-47 name=__codelineno-30-47 href=#__codelineno-30-47></a><span class=s2>    return a * b</span>
</span><span id=__span-30-48><a id=__codelineno-30-48 name=__codelineno-30-48 href=#__codelineno-30-48></a><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-30-49><a id=__codelineno-30-49 name=__codelineno-30-49 href=#__codelineno-30-49></a>
</span><span id=__span-30-50><a id=__codelineno-30-50 name=__codelineno-30-50 href=#__codelineno-30-50></a><span class=n>test_cases</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-30-51><a id=__codelineno-30-51 name=__codelineno-30-51 href=#__codelineno-30-51></a>    <span class=p>{</span><span class=s2>&quot;call&quot;</span><span class=p>:</span> <span class=s2>&quot;add(2, 3)&quot;</span><span class=p>,</span> <span class=s2>&quot;expected&quot;</span><span class=p>:</span> <span class=mi>5</span><span class=p>},</span>
</span><span id=__span-30-52><a id=__codelineno-30-52 name=__codelineno-30-52 href=#__codelineno-30-52></a>    <span class=p>{</span><span class=s2>&quot;call&quot;</span><span class=p>:</span> <span class=s2>&quot;add(-1, 1)&quot;</span><span class=p>,</span> <span class=s2>&quot;expected&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>},</span>
</span><span id=__span-30-53><a id=__codelineno-30-53 name=__codelineno-30-53 href=#__codelineno-30-53></a>    <span class=p>{</span><span class=s2>&quot;call&quot;</span><span class=p>:</span> <span class=s2>&quot;multiply(3, 4)&quot;</span><span class=p>,</span> <span class=s2>&quot;expected&quot;</span><span class=p>:</span> <span class=mi>12</span><span class=p>},</span>
</span><span id=__span-30-54><a id=__codelineno-30-54 name=__codelineno-30-54 href=#__codelineno-30-54></a>    <span class=p>{</span><span class=s2>&quot;call&quot;</span><span class=p>:</span> <span class=s2>&quot;multiply(0, 5)&quot;</span><span class=p>,</span> <span class=s2>&quot;expected&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>},</span>
</span><span id=__span-30-55><a id=__codelineno-30-55 name=__codelineno-30-55 href=#__codelineno-30-55></a><span class=p>]</span>
</span><span id=__span-30-56><a id=__codelineno-30-56 name=__codelineno-30-56 href=#__codelineno-30-56></a>
</span><span id=__span-30-57><a id=__codelineno-30-57 name=__codelineno-30-57 href=#__codelineno-30-57></a><span class=nb>print</span><span class=p>(</span><span class=n>test_user_code</span><span class=p>(</span><span class=n>user_code</span><span class=p>,</span> <span class=n>test_cases</span><span class=p>))</span>
</span></code></pre></div> <h2 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">&para;</a></h2> <h3 id=1-always-use-context-managers>1. Always Use Context Managers<a class=headerlink href=#1-always-use-context-managers title="Permanent link">&para;</a></h3> <p>Always use the <code>with</code> statement to ensure proper cleanup:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=c1># Good </span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;print(&#39;Hello&#39;)&quot;</span><span class=p>)</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=c1># Avoid </span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=n>session</span> <span class=o>=</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>)</span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=n>session</span><span class=o>.</span><span class=n>open</span><span class=p>()</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;print(&#39;Hello&#39;)&quot;</span><span class=p>)</span>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=n>session</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>  <span class=c1># Easy to forget!</span>
</span></code></pre></div> <h3 id=2-handle-errors-gracefully>2. Handle Errors Gracefully<a class=headerlink href=#2-handle-errors-gracefully title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>        <span class=k>if</span> <span class=n>result</span><span class=o>.</span><span class=n>exit_code</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>stderr</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Output: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Sandbox error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <h3 id=3-use-security-policies>3. Use Security Policies<a class=headerlink href=#3-use-security-policies title="Permanent link">&para;</a></h3> <p>Always use security policies and check if the code is safe before running it:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox.security</span><span class=w> </span><span class=kn>import</span> <span class=n>SecurityPolicy</span><span class=p>,</span> <span class=n>SecurityPattern</span><span class=p>,</span> <span class=n>SecurityIssueSeverity</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=c1># Create a security policy</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=n>policy</span> <span class=o>=</span> <span class=n>SecurityPolicy</span><span class=p>(</span>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>    <span class=n>severity_threshold</span><span class=o>=</span><span class=n>SecurityIssueSeverity</span><span class=o>.</span><span class=n>MEDIUM</span><span class=p>,</span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>    <span class=n>patterns</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>        <span class=n>SecurityPattern</span><span class=p>(</span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>            <span class=n>pattern</span><span class=o>=</span><span class=sa>r</span><span class=s2>&quot;os\.system&quot;</span><span class=p>,</span>
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;System command execution&quot;</span><span class=p>,</span>
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a>            <span class=n>severity</span><span class=o>=</span><span class=n>SecurityIssueSeverity</span><span class=o>.</span><span class=n>HIGH</span>
</span><span id=__span-33-12><a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a>        <span class=p>),</span>
</span><span id=__span-33-13><a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a>        <span class=n>SecurityPattern</span><span class=p>(</span>
</span><span id=__span-33-14><a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a>            <span class=n>pattern</span><span class=o>=</span><span class=sa>r</span><span class=s2>&quot;eval\s*\(&quot;</span><span class=p>,</span>
</span><span id=__span-33-15><a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Dynamic code evaluation&quot;</span><span class=p>,</span>
</span><span id=__span-33-16><a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a>            <span class=n>severity</span><span class=o>=</span><span class=n>SecurityIssueSeverity</span><span class=o>.</span><span class=n>MEDIUM</span>
</span><span id=__span-33-17><a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a>        <span class=p>)</span>
</span><span id=__span-33-18><a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a>    <span class=p>]</span>
</span><span id=__span-33-19><a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a><span class=p>)</span>
</span><span id=__span-33-20><a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a>
</span><span id=__span-33-21><a id=__codelineno-33-21 name=__codelineno-33-21 href=#__codelineno-33-21></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span><span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span> <span class=n>security_policy</span><span class=o>=</span><span class=n>policy</span><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-33-22><a id=__codelineno-33-22 name=__codelineno-33-22 href=#__codelineno-33-22></a>    <span class=c1># Check if code is safe before running</span>
</span><span id=__span-33-23><a id=__codelineno-33-23 name=__codelineno-33-23 href=#__codelineno-33-23></a>    <span class=n>code</span> <span class=o>=</span> <span class=s2>&quot;print(&#39;This is safe code&#39;)&quot;</span>
</span><span id=__span-33-24><a id=__codelineno-33-24 name=__codelineno-33-24 href=#__codelineno-33-24></a>    <span class=n>is_safe</span><span class=p>,</span> <span class=n>violations</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>is_safe</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
</span><span id=__span-33-25><a id=__codelineno-33-25 name=__codelineno-33-25 href=#__codelineno-33-25></a>
</span><span id=__span-33-26><a id=__codelineno-33-26 name=__codelineno-33-26 href=#__codelineno-33-26></a>    <span class=k>if</span> <span class=n>is_safe</span><span class=p>:</span>
</span><span id=__span-33-27><a id=__codelineno-33-27 name=__codelineno-33-27 href=#__codelineno-33-27></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>code</span><span class=p>)</span>
</span><span id=__span-33-28><a id=__codelineno-33-28 name=__codelineno-33-28 href=#__codelineno-33-28></a>        <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span><span id=__span-33-29><a id=__codelineno-33-29 name=__codelineno-33-29 href=#__codelineno-33-29></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-33-30><a id=__codelineno-33-30 name=__codelineno-33-30 href=#__codelineno-33-30></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Code failed security check:&quot;</span><span class=p>)</span>
</span><span id=__span-33-31><a id=__codelineno-33-31 name=__codelineno-33-31 href=#__codelineno-33-31></a>        <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>violations</span><span class=p>:</span>
</span><span id=__span-33-32><a id=__codelineno-33-32 name=__codelineno-33-32 href=#__codelineno-33-32></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  - </span><span class=si>{</span><span class=n>v</span><span class=o>.</span><span class=n>description</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <h3 id=4-use-your-own-pre-built-images>4. Use Your Own Pre-built Images<a class=headerlink href=#4-use-your-own-pre-built-images title="Permanent link">&para;</a></h3> <p>You can use your own pre-built images with appropriate dependencies and environment set up by specifying the <code>image</code> parameter when creating a sandbox session. It can be useful for running code that requires specific dependencies or environment variables. Since the image is pre-built, it will be faster to run the code without the need to build the image or install dependencies.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>    <span class=n>image</span><span class=o>=</span><span class=s2>&quot;ghcr.io/vndee/sandbox-python-311-bullseye&quot;</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;print(&#39;Hello from my custom image!&#39;)&quot;</span><span class=p>)</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></code></pre></div> <h3 id=5-skip-environment-setup-for-production>5. Skip Environment Setup for Production<a class=headerlink href=#5-skip-environment-setup-for-production title="Permanent link">&para;</a></h3> <p>For production deployments or when using pre-configured images, skip automatic environment setup for faster container startup:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llm_sandbox</span><span class=w> </span><span class=kn>import</span> <span class=n>SandboxSession</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=c1># Skip environment setup when using custom images</span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span>
</span><span id=__span-35-5><a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
</span><span id=__span-35-6><a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>    <span class=n>image</span><span class=o>=</span><span class=s2>&quot;my-registry.com/python-ml:latest&quot;</span><span class=p>,</span>  <span class=c1># Pre-configured image</span>
</span><span id=__span-35-7><a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a>    <span class=n>skip_environment_setup</span><span class=o>=</span><span class=kc>True</span>  <span class=c1># Skip pip upgrades and venv creation</span>
</span><span id=__span-35-8><a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-35-9><a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s2>&quot;import numpy; print(&#39;Ready!&#39;)&quot;</span><span class=p>)</span>
</span></code></pre></div> <p><strong>When to use <code>skip_environment_setup=True</code>:</strong></p> <ul> <li>Production deployments where startup time is critical</li> <li>Custom images with pre-installed packages</li> <li>CI/CD pipelines and batch processing</li> <li>Air-gapped environments without external package access</li> </ul> <p>See the <a href=../configuration/#environment-setup-control>Configuration Guide</a> for detailed information.</p> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h2> <h3 id=container-runtime-not-found>Container Runtime Not Found<a class=headerlink href=#container-runtime-not-found title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=c1># Check Docker</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>docker<span class=w> </span>--version
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=c1># Check Podman</span>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a>podman<span class=w> </span>--version
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a>
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=c1># Check Kubernetes</span>
</span><span id=__span-36-8><a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>kubectl<span class=w> </span>version
</span></code></pre></div> <h3 id=permission-errors>Permission Errors<a class=headerlink href=#permission-errors title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=c1># Run as non-root user</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=k>with</span> <span class=n>SandboxSession</span><span class=p>(</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>    <span class=n>lang</span><span class=o>=</span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>    <span class=n>runtime_configs</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;user&quot;</span><span class=p>:</span> <span class=s2>&quot;1000:1000&quot;</span><span class=p>},</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>    <span class=n>workdir</span><span class=o>=</span><span class=s2>&quot;/tmp/sandbox&quot;</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=p>)</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>    <span class=k>pass</span>
</span></code></pre></div> <h3 id=import-errors>Import Errors<a class=headerlink href=#import-errors title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=c1># Install backend-specific dependencies</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>pip<span class=w> </span>install<span class=w> </span><span class=s1>&#39;llm-sandbox[docker]&#39;</span>
</span></code></pre></div> <h2 id=next-steps>Next Steps<a class=headerlink href=#next-steps title="Permanent link">&para;</a></h2> <ul> <li>Learn about <a href=../configuration/ >Configuration Options</a></li> <li>Explore <a href=../security/ >Security Policies</a></li> <li>Understand <a href=../backends/ >Container Backends</a></li> <li>Check out more <a href=../examples/ >Examples</a></li> <li>Read the <a href=../api-reference/ >API Reference</a></li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 19, 2025 09:57:19 UTC"><span class=timeago datetime=2025-10-19T09:57:19+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 19, 2025 09:57:19 UTC">2025-10-19</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="May 26, 2025 15:27:26 UTC"><span class=timeago datetime=2025-05-26T15:27:26+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="May 26, 2025 15:27:26 UTC">2025-05-26</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=.. class="md-footer__link md-footer__link--prev" aria-label="Previous: Home"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Home </div> </div> </a> <a href=../configuration/ class="md-footer__link md-footer__link--next" aria-label="Next: Configuration"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Configuration </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 Duy Huynh - Maintained by <a href=https://blog.duy.dev>vndee</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/vndee/llm-sandbox target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://pypi.org/project/llm-sandbox/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg> </a> <a href=https://hub.docker.com/u/vndee target=_blank rel=noopener title=hub.docker.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg> </a> <a href=https://linkedin.com/in/vndee target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://blog.duy.dev target=_blank rel=noopener title=blog.duy.dev class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.4c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.3c2.2 20.4 3.3 41.8 3.3 64m28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64m112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 20.9 58.2 27 94.7m-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6M8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64m186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.7z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better. </p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../assets/javascripts/bundle.13a4f30d.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> <script src=../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>